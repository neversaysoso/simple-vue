{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isObject(data) {\r\n  return typeof data === 'object' && data !== null\r\n}\r\n\r\nexport function def(data, key, value) {\r\n  Object.defineProperty(data, key, {\r\n    enumerable: false,\r\n    configurable: false,\r\n    value\r\n  })\r\n}","let oldarrayMethods = Array.prototype\r\n\r\nexport const arrayMethods = Object.create(oldarrayMethods)\r\n\r\nconst methods = [\r\n  'push',\r\n  'shift',\r\n  'unshift',\r\n  'pop',\r\n  'sort',\r\n  'splice',\r\n  'reverse'\r\n]\r\n\r\nmethods.forEach(method => {\r\n  arrayMethods[method] = function (...args) {\r\n    const result = oldarrayMethods[method].apply(this, args)\r\n    let ob = this.__ob__\r\n    let inserted\r\n    switch (method) {\r\n      case 'push':\r\n      case 'unshift':\r\n        inserted = args\r\n        break;\r\n      case 'splice':\r\n        inserted = args.slice(2)\r\n      default:\r\n        break;\r\n    }\r\n\r\n    if (inserted) ob.observeArray(inserted)\r\n\r\n    return result\r\n  }\r\n});","import {\r\n  isObject,\r\n  def\r\n} from '../utils/index'\r\n\r\nimport {\r\n  arrayMethods\r\n} from './array'\r\n\r\nclass Observer {\r\n  constructor(value) {\r\n    def(value, '__ob__', this)\r\n    if (Array.isArray(value)) {\r\n      value.__proto__ = arrayMethods\r\n      this.observeArray(value)\r\n    } else {\r\n      this.walk(value)\r\n    }\r\n  }\r\n\r\n  walk(data) {\r\n    Object.keys(data).forEach(key => {\r\n      defineReactive(data, key, data[key])\r\n    })\r\n  }\r\n\r\n  observeArray(value) {\r\n    value.forEach(v => {\r\n      observe(v)\r\n    })\r\n  }\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n  observe(value) // 递归实现深度检测\r\n  Object.defineProperty(data, key, {\r\n    set(newVal) {\r\n      if (newVal !== value) {\r\n        console.log('更新数据')\r\n        observe(value)\r\n        value = newVal\r\n      } else {\r\n        return\r\n      }\r\n    },\r\n    get() {\r\n      return value\r\n    }\r\n  })\r\n}\r\n\r\nexport function observe(data) {\r\n  let isObj = isObject(data)\r\n  if (!isObj) {\r\n    return\r\n  }\r\n  return new Observer(data)\r\n}","import {\r\n  observe\r\n} from './observer/index.js'\r\n\r\nexport function initState(vm) {\r\n  const opts = vm.$options\r\n  if (opts.props) {\r\n    initProps(vm)\r\n  }\r\n\r\n  if (opts.methods) {\r\n    initMethod(vm)\r\n  }\r\n\r\n  if (opts.data) {\r\n    initData(vm)\r\n  }\r\n\r\n  if (opts.computed) {\r\n    initComputed(vm)\r\n  }\r\n\r\n  if (opts.watch) {\r\n    initWatch(vm)\r\n  }\r\n}\r\n\r\nfunction initProps() {}\r\n\r\nfunction initMethod() {}\r\n\r\nfunction initData(vm) {\r\n  let data = vm.$options.data\r\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\r\n  observe(data)\r\n}\r\n\r\nfunction initComputed() {}\r\n\r\nfunction initWatch() {}","import {\r\n  initState\r\n} from './state'\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    const vm = this\r\n    vm.$options = options\r\n\r\n    initState(vm)\r\n  }\r\n}","import {\r\n  initMixin\r\n} from './init'\r\n\r\nclass Vue {\r\n  constructor(options) {\r\n    this._init(options)\r\n  }\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue"],"names":["isObject","data","def","key","value","Object","defineProperty","enumerable","configurable","oldarrayMethods","Array","prototype","arrayMethods","create","methods","forEach","method","args","result","apply","ob","__ob__","inserted","slice","observeArray","Observer","isArray","__proto__","walk","keys","defineReactive","v","observe","set","newVal","console","log","get","isObj","initState","vm","opts","$options","props","initData","computed","watch","_data","call","initMixin","Vue","_init","options"],"mappings":"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"}